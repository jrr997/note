# 移动端适配方案

## flexible(0.3.2)

flexible(0.3.2)是2014年手淘H5的多端适配方案，目前已经不推荐使用。

原理：动态改写meta标签，根据不同的dpr来放大页面(缩小视觉视口)，达到页面等比例缩放。使用rem模拟vw特性。

1. 获取手机dpr，设置viewport的scale为1/dpr。
2. 获取浏览器窗口大小(`getBoundingClientRect().width`),设置html标签的`font-size` = 浏览器宽度 / 10。即1rem = 1/10宽度。
3. 根据dpr设置全局文字大小(利用css继承性，body标签上的`font-size = 12px * dpr`)。

用法：

1. 首先我们要准备一套用rem写好的页面。(怕px转rem麻烦的话，可以考虑用css预处理器的函数功能或者px2rem插件)

缺点：

1. 不支持安卓设备的高清方案(安卓设备的scale始终为1)
2. 不支持iframe的适配



## flexible(2.0)

2.0与0.3.2的基本原理相同，也是在viewport上作文章，用rem模拟vw。不同的是：

1. 2.0把布局视口为理想视口(`<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">`)。
2. 新增hairlines。如果设备支出0.5px，则把所有div的border-width = 0.5px,解决1px问题。

相比于0.3.2，2.0的方案；能支持绝大部分的移动终端适配。



## vw方案

vw是一个天然的相对于视口大小的单位，这里的视口是指浏览器的可视区域，可用`window.innerWidth/window.innerHeight`获取。`100vw = window.innerWidth`。

我们可以根据设计稿用px写页面，然后通过 [postcss-px-to-viewport](https://github.com/evrone/postcss-px-to-viewport)把px单位转为vw。

相比于flexible的hack方法用rem模拟vw，vw利用了原生的css特性完成移动端适配。vw相比于rem，主要是兼容性问题。现代浏览器IE9以上、android 4.4和iOS8以上都支持vw。



# 总结

移动端的适配就是让页面**等比例缩放来适配不同的终端**。其主要有两个步骤：

1. 使页面有等比例缩放的能力(把px单位转为rem单位或vw单位)。
2. 根据手机屏幕宽度来设置页面缩放比例。

当然还有一个必要的前提条件：**要令视觉视口为理想视口**。

